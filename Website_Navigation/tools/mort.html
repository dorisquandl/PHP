 <title>房屋按揭计算 - 房屋买卖 - 51房屋 -加国无忧</title>
    <style>
    .PopupBody4{ padding: 20px;text-align: left;}
    .PopupBody4 h2{font-size: 16px; margin:0 0 10px; padding-left: 10px; border-left: 3px solid #508644;}
    .PopupBody4 FONT		{FONT-FAMILY: Arial,Verdana,Helvetica,sans-serif; FONT-SIZE: 12px}
    .PopupBody4 BODY		{FONT-FAMILY: Arial,Verdana,Helvetica,sans-serif; CURSOR: default; FONT-SIZE: 12px; COLOR: #333333; SCROLLBAR-BASE-COLOR: #669900; SCROLLBAR-ARROW-COLOR: FFFFFF}

    .PopupBody4 P			{FONT-FAMILY: Arial,Verdana,Helvetica,sans-serif; FONT-SIZE: 12px;  COLOR: #333333}
    .PopupBody4 TD			{FONT-FAMILY: Arial,Verdana,Helvetica,sans-serif; FONT-SIZE: 12px;  COLOR: #333333; padding:5px;}
    .PopupBody4 TR			{FONT-FAMILY: Arial,Verdana,Helvetica,sans-serif; FONT-SIZE: 12px;  COLOR: #333333}
    .PopupBody4 UL			{FONT-FAMILY: Arial,Verdana,Helvetica,sans-serif; FONT-SIZE: 12px;  COLOR: #333333}
    .PopupBody4 LI			{FONT-FAMILY: Arial,Verdana,Helvetica,sans-serif; FONT-SIZE: 12px;  COLOR: #333333}

    .PopupBody4 FORM		{FONT-FAMILY: Arial,Verdana,Helvetica,sans-serif; FONT-SIZE: 12px}
    .PopupBody4 SELECT		{FONT-FAMILY: Arial,Verdana,Helvetica,sans-serif; FONT-SIZE: 12px;}
    .PopupBody4 TEXTAREA	{FONT-FAMILY: Arial,Verdana,Helvetica,sans-serif; BACKGROUND-COLOR: #EEEEEE; COLOR: #333333; FONT-SIZE: 12px;}
    .PopupBody4 OPTION		{FONT-FAMILY: Arial,Verdana,Helvetica,sans-serif; FONT-SIZE: 12px;}
    .PopupBody4 INPUT		{FONT-FAMILY: Arial,Verdana,Helvetica,sans-serif; COLOR: #333333; FONT-SIZE: 12px;}

    .PopupBody4 A:active	{COLOR: #FF0000;}
    .PopupBody4 A:visited	{COLOR: #333333; TEXT-DECORATION: none}
    .PopupBody4 A:hover		{COLOR: #FF0000;TEXT-DECORATION: underline}
    .PopupBody4 A:link		{COLOR: #333333; TEXT-DECORATION: none}

    .PopupBody4 A.blink:active, A.blink:hover	{COLOR: #FF0000;}
    .PopupBody4 A.blink:visited,A.blink:link	{COLOR: #333366;;TEXT-DECORATION: underline}

    .PopupBody4 .bginput		{FONT-FAMILY: "ËÎÌå",Arial,Verdana,Helvetica,sans-serif; FONT-SIZE: 12px; COLOR: #333333; HEIGHT: 18px; BACKGROUND-COLOR: #CCCCCC}

    .PopupBody4 table.mort{ background-color: #efefef; padding: 20px;}
    .PopupBody4 table.mort input{ border: 0;padding: 5px; width: 100%;}
    .PopupBody4 table.mort input.submit-btn{
          width: 100%;
          color: #777;
          font-weight: bold;
          font-size: 14px;
          background: #ccc;
          border: 0;
          padding: 10px;
          outline:none;
        }
    .PopupBody4 table.mort input.submit-btn:hover{
            background-color: #888;
            color:#fff;
          }
    .PopupBody4 table.mort input.submit-btn:active{
            -moz-box-shadow:    inset 0 0 6px #333;
            -webkit-box-shadow: inset 0 0 6px #333;
            box-shadow:         inset 0 0 6px #333;
          }
    </style>
    <SCRIPT LANGUAGE="JavaScript">
        <!--
        var moPmt='';
        var ie4=document.all&&!document.getElementById
        var ns4=document.layers
        var DOM2=document.getElementById

        function validNums(refVal) {
            var bValid=true;
            for (var i=0; i < refVal.value.length; i++) {
                var c = refVal.value.charCodeAt(i);
                if ((c > 57 || c < 48)) {
                    bValid=false;
                }
            }
            if (bValid==false) {
                alert('You can only enter numbers into this field.');
                refVal.focus();
                refVal.select();
                return false;
            }
            else {
                return true; }
        }

        function validNumsDec(refVal) {
            var decm = false;
            var bDec = true;
            var bValid = true;
            for (var i=0; i < refVal.value.length; i++) {
                var c = refVal.value.charCodeAt(i);
                if ((c > 57 || c < 48)) {
                    if (c==46) {
                        if (decm == true) {
                            var bDec = false; }
                        else {
                            decm = true; } }
                    else if (c==44) { }
                    else {
                        bValid = false; }
                }
            }
            if (bValid==false || bDec==false) {
                alert('You can only enter numbers, commas and one decimal into this field.');
                refVal.focus();
                refVal.select();
                return false;
            }
            else return true;
        }

        function formatNum(num) {

            num = parseFloat(num);
            num = Math.round(100*num);
            num = num.toString();
            var p1 = num.substring(0, num.length - 2);
            var p2 = num.substring(num.length - 2, num.length);
            num = p1 + '.' + p2;

            var txtNumber = '' + num;
            var rxSplit = new RegExp('([0-9])([0-9][0-9][0-9][,.])');
            var arrNumber = txtNumber.split('.');
            arrNumber[0] += '.';
            do {
                arrNumber[0] = arrNumber[0].replace(rxSplit, '$1,$2');
            } while (rxSplit.test(arrNumber[0]));

            if (arrNumber.length > 1) {
                return arrNumber.join('');
            }
            else {
                return arrNumber[0].split('.')[0];
            }
        }

        function computeForm(theform) {
            /*
             if(theform.principal.value == "" || theform.principal.value == 0) {
             alert("Please enter an amount in Line #1.");
             theform.principal.focus();
             } else if(theform.intRate.value == "" || theform.intRate.value == 0) {
             alert("Please enter an amount in Line #2.");
             theform.intRate.focus();
             } else if(theform.numYears.value == "" || theform.numYears.value == 0) {
             alert("Please enter an amount in Line #3.");
             theform.numYears.focus();
             } else {
             */
            //COMPUTE MIF
            var payFreq = theform.payFreq.options[theform.payFreq.selectedIndex].value;

            if(theform.intRate.value < 1) {
                var annInt = theform.intRate.value * 100;
            } else {
                var annInt = theform.intRate.value;
            }

            var MIFfactor1 = 2 * 100;
            var MIFfactor2 = annInt / MIFfactor1;
            var MIFfactor3 = eval(MIFfactor2) + eval(1);
            var MIFfactor4 = Math.pow(MIFfactor3,2);
            var MIFfactor5 = 1 /payFreq;
            var MIFfactor6 = Math.pow(MIFfactor4,MIFfactor5);
            var MIFfactor7 = eval(MIFfactor6) - eval(1);
            var MIF = MIFfactor7;

            //COMPUTE PIP
            var prin = theform.principal.value;
            var noYrs = theform.numYears.value;
            var PIPfactor1 = eval(MIF) + eval(1);
            var PIPfactor2 = eval(noYrs) - eval(noYrs * 2);
            var PIPfactor3 = PIPfactor2 * payFreq;
            var PIPfactor4 = Math.pow(PIPfactor1,PIPfactor3);
            var PIPfactor5 = eval(1) - eval(PIPfactor4);
            var PIPfactor6 = prin * MIF;
            var PIPfactor7 = PIPfactor6 / PIPfactor5;
            var PIP = PIPfactor7;

            //theform.moPmt.value = formatNum(PIP);
            moPmt = '<b>'+formatNum(PIP)+'</b>';

            if (DOM2){
                document.getElementById("moPmtlayer").style.color="rgb(255,0,0)";
                document.getElementById("moPmtlayer").innerHTML=moPmt;
            }else if (ie4){
                document.all.moPmtlayer.innerHTML=moPmt;
            }else if (ns4){
                document.moPmtlayerNS.document.moPmtlayerNS_sub.document.write(moPmt);
                document.moPmtlayerNS.document.moPmtlayerNS_sub.document.close();
            }

            theform.amortYrs.selectedIndex = theform.termLength.value;
            /*
             for (counter = 0; counter < theform.length; counter ++) {
             if (theform[counter].value == 'N.aN') { theform[counter].value = ''; }
             }
             */
            //}
            return;
        }

        function mortCal(theform) {
            if(theform.principal.value.length > 0 && theform.numYears.value.length > 0 && theform.intRate.value.length > 0){
                computeForm(theform);
            }
            return;
        }

        function validate(theform) {

            var MAX_PRINCIPAL = 2000000;
            var MIN_PRINCIPAL = 5000;
            var MAX_INTRATE = 13;
            var MIN_INTRATE = 1;
            var MAX_TERM = 10;
            var MIN_TERM = 1;
            var MAX_PERIOD = 30;
            var MIN_PERIOD = 1;

            var PRINCIPAL = Number(theform.principal.value);
            var INTRATE = Number(theform.intRate.value);
            var TERM = Number(theform.termLength.value);
            var PERIOD = Number(theform.numYears.value);

            if (PRINCIPAL > MAX_PRINCIPAL) {
                alert('The principal amount you have entered is too high. Please reduce it before proceeding.');
                theform.principal.focus(); theform.principal.select();
                return false; }
            if (INTRATE > MAX_INTRATE) {
                alert('The interest rate you have entered is too high. Please reduce it before proceeding.');
                theform.intRate.focus(); theform.intRate.select();
                return false; }
            if (TERM > MAX_TERM) {
                alert('The term length you have entered is too high. Please reduce it before proceeding.');
                theform.termLength.focus(); theform.termLength.select();
                return false; }
            if (PERIOD > MAX_PERIOD) {
                alert('The amortization period length you have entered is too high. Please reduce it before proceeding.');
                theform.numYears.focus(); theform.numYears.select();
                return false; }
            if (PRINCIPAL < MIN_PRINCIPAL) {
                alert('The principal amount you have entered is too low. Please increase it before proceeding.');
                theform.principal.focus(); theform.principal.select();
                return false; }
            if (INTRATE < MIN_INTRATE) {
                alert('The interest rate you have entered is too low. Please increase it before proceeding.');
                theform.intRate.focus(); theform.intRate.select();
                return false; }
            if (TERM < MIN_TERM) {
                alert('The term length you have entered is too low. Please increase it before proceeding.');
                theform.termLength.focus(); theform.termLength.select();
                return false; }
            if (PERIOD < MIN_PERIOD) {
                alert('The amortization period length you have entered is too low. Please increase it before proceeding.');
                theform.numYears.focus(); theform.numYears.select();
                return false; }
            if (TERM > PERIOD) {
                alert('Your term exceeds your amortization period. Please reduce the term below the period.');
                theform.termLength.focus(); theform.termLength.select();
                return false; }

            createReport(theform);
            return true;
        }

        function days_after(selectedDate, numDays) {
            // parse s for month, day, year
            var dateArray = selectedDate.split('/');

            sdate = new Date(dateArray[2],dateArray[0]-1,dateArray[1]);

            var odate = new Date(sdate.getTime() + (numDays * 86400000));
            currentMonth = odate.getMonth() + 1;
            currentYear = odate.getYear();

            var newdateStr='';

            if((odate.getMonth()+1)<10){
                newdateStr += '0'+(odate.getMonth()+1);
            }else{
                newdateStr += (odate.getMonth()+1);
            }

            newdateStr += '/';

            if(odate.getDate()<10){
                newdateStr += '0'+odate.getDate();
            }else{
                newdateStr += odate.getDate();
            }

            newdateStr += '/' + odate.getYear();

            return newdateStr;
        }

        function createReport(theform) {

            //GRAB VARIABLES
            var freqTxt = theform.payFreq.options[theform.payFreq.selectedIndex].text;
            var payFreq = theform.payFreq.options[theform.payFreq.selectedIndex].value;

            //COMPUTE MIF
            if(theform.intRate.value < 1) {
                var annInt = theform.intRate.value * 100;
            } else {
                var annInt = theform.intRate.value;
            }
            var MIFfactor1 = 2 * 100;
            var MIFfactor2 = annInt / MIFfactor1;
            var MIFfactor3 = eval(MIFfactor2) + eval(1);
            var MIFfactor4 = Math.pow(MIFfactor3,2);
            var MIFfactor5 = 1 /payFreq;
            var MIFfactor6 = Math.pow(MIFfactor4,MIFfactor5);
            var MIFfactor7 = eval(MIFfactor6) - eval(1);
            var MIF = MIFfactor7;

            //COMPUTE PIP
            var prin = theform.principal.value;
            var noYrs = theform.numYears.value;
            var PIPfactor1 = eval(MIF) + eval(1);
            var PIPfactor2 = eval(noYrs) - eval(noYrs * 2);
            var PIPfactor3 = PIPfactor2 * payFreq;
            var PIPfactor4 = Math.pow(PIPfactor1,PIPfactor3);
            var PIPfactor5 = eval(1) - eval(PIPfactor4);
            var PIPfactor6 = prin * MIF;
            var PIPfactor7 = PIPfactor6 / PIPfactor5;
            var PIP = PIPfactor7;

            //theform.moPmt.value = formatNum(PIP);

            //CALCULATE AMORT
            var aPrin = prin;
            var aIntRate = MIF;
            var aNPer = noYrs * payFreq;
            var aPmt = PIP;

            var aIntPort = 0;
            var aAccumInt = 0;
            var aPrinPort = 0;
            var aAccumPrin = 0;
            var aCount = 0;
            var aPmtRow = "";
            var aPmtNum = 0;

            //var today = new Date();
            //var dayFactor = today.getTime();
            //var pmtDay = today.getDate();
            //var loanMM = today.getMonth() + 1;
            //var loanYY = today.getYear();

            //ADDITION
            var Vmonth = Number(theform.month.selectedIndex) + 1;
            var Vday = Number(theform.day.selectedIndex) + 1;
            var Vyear = Number(theform.year.selectedIndex) + 2010;
            var Vterm = Number(theform.termLength.value);

            var loanDate = (Vmonth + "/" + Vday + "/" + Vyear);
            //var monthMS = 86400000 * 30.4;
            //var pmtDate = 0;
            var PayFreqTime = 1;

            if (payFreq == 1) { PayFreqTime = 12; }
            else if (payFreq == 2) { PayFreqTime = 6; }
            else if (payFreq == 4) { PayFreqTime = 3; }
            else if (payFreq == 12) { PayFreqTime = 1; }
            else if (payFreq == 26) { var numDays = 14; }
            else if (payFreq == 52) { var numDays = 7; }

            var VamortYrs= Number(theform.amortYrs.selectedIndex);

            if(VamortYrs>noYrs) { VamortYrs=noYrs; }

            var numDisplay = VamortYrs * payFreq;

            var dayCount = 0;
            var yearCount = 0;
            var totalDayCount = 0;
            var makeRow = false;
            var makeTermRow = false;
            var makeYearRow = false;
            var lastYear = Vyear;
            var termCount = Vterm;
            var yearTotalPrin = new Array();
            var yearTotalInt = new Array();
            var yearTotalBalance = new Array();
            currentMonth = Vmonth;

            while(aCount < aNPer) {
                aIntPort = aPrin * aIntRate;
                aAccumInt = eval(aAccumInt) + eval(aIntPort);
                aPrinPort = eval(aPmt) - eval(aIntPort);
                aAccumPrin = eval(aAccumPrin) + eval(aPrinPort);
                aPrin = eval(aPrin) - eval(aPrinPort);
                aCount = eval(aCount) + eval(1);
                aPmtNum = eval(aPmtNum) + eval(1);

                if (payFreq >= 26) {
                    dayCount += numDays;
                    totalDayCount += numDays;
                    if (dayCount > 28 || (dayCount >=21 && numDays == 14)) {

                        pmtString = days_after(Vmonth + "/" + Vday + "/" + Vyear, totalDayCount);

                        if ((Vmonth == currentMonth && lastYear != currentYear) || (lastYear != currentYear && numDays == 7)) {
                            if (termCount != 0) {
                                termCount --;
                            }
                            makeRow = false;
                            makeTermRow = false;
                            makeYearRow = true;
                            lastYear = currentYear;
                        }else {
                            makeYearRow = false;
                            if (termCount == 0) {
                                makeRow = true;
                            } else {
                                makeTermRow = true;
                            }
                        }

                        dayCount = 0;
                    }else {
                        makeRow = false;
                        makeTermRow = false;
                    }
                } else {
                    Vmonth += PayFreqTime;
                    if(Vmonth > 12) {
                        Vmonth = Vmonth - 12;
                        Vyear = Vyear + 1;
                    }

                    if (termCount == 0) {
                        makeRow = true;
                    } else {
                        makeTermRow = true;
                    }
                    if (Vterm == 777 && termCount != 0) {
                        termCount --;
                    }
                    makeYearRow = false;

                    var VmonthStr='';
                    var VdayStr='';

                    if ( Vmonth<10 )	{	VmonthStr = "0" + Vmonth;	}
                    else {	VmonthStr = Vmonth;}

                    if ( Vday<10 )		{	VdayStr = "0" + Vday;	}
                    else { VdayStr = Vday; }

                    pmtString = (VmonthStr + "/" + VdayStr + "/" + Vyear);

                    if (lastYear != Vyear && Vmonth == currentMonth) {
                        makeYearRow = true;
                        makeRow = false;
                        makeTermRow = false;
                        if (termCount != 0) {
                            termCount --;
                        }
                    }
                }

                if (makeTermRow == true) {
                    if (numDisplay > 0) {
                        aPmtRow = ("" + aPmtRow + "<TR><TD ALIGN=CENTER bgcolor='#FFFFFF'>" + aPmtNum + "</TD><TD ALIGN=CENTER bgcolor='#FFFFFF'>" + pmtString + "</TD><TD ALIGN=RIGHT bgcolor='#FFFFFF'>\$" + formatNum(aPrinPort) + "</TD><TD ALIGN=RIGHT bgcolor='#FFFFFF'>\$" + formatNum(aIntPort) + "</TD><TD ALIGN=RIGHT bgcolor='#FFFFFF'>\$" + formatNum(aPrin) + "</TD></TR>");
                    }
                    makeRow = false;
                }else if (makeYearRow == true) {
                    if (numDisplay > 0) {
                        aPmtRow = ("" + aPmtRow + "<TR><TD ALIGN=CENTER bgcolor='#F1F1F1'>" + aPmtNum + "</TD><TD ALIGN=CENTER bgcolor='#F1F1F1'>" + pmtString + "</TD><TD ALIGN=RIGHT bgcolor='#F1F1F1'>\$" + formatNum(aPrinPort) + "</TD><TD ALIGN=RIGHT bgcolor='F1F1F1'>$" + formatNum(aIntPort) + "</TD><TD ROWSPAN=2 ALIGN=RIGHT bgcolor='#EEEEEE'><B>\$" + formatNum(aPrin) + "</B></TD></TR>");

                        aPmtRow = ("" + aPmtRow + "<TR><TD ALIGN=CENTER bgcolor='#EEEEEE'><B>---</B></TD><TD ALIGN=CENTER bgcolor='#EEEEEE'><B>YTD Total</B></TD><TD ALIGN=RIGHT bgcolor='#EEEEEE'><B>\$" + formatNum(aAccumPrin) + "</B></TD><TD ALIGN=RIGHT bgcolor='#EEEEEE'><B>\$" + formatNum(aAccumInt) + "</B></TD></TR>");
                    }

                    yearCount ++;
                    yearTotalPrin[yearCount] = aAccumPrin;
                    yearTotalInt[yearCount] = aAccumInt;
                    yearTotalBalance[yearCount] = aPrin;
                    makeYearRow = false;
                } else if (makeRow == true) {
                    if (numDisplay > 0) {
                        aPmtRow = ("" + aPmtRow + "<TR><TD ALIGN=CENTER bgcolor='#CCFFFF'>" + aPmtNum + "</TD><TD ALIGN=CENTER bgcolor='#CCFFFF'>" + pmtString + "</TD><TD ALIGN=RIGHT bgcolor='#CCFFFF'>\$" + formatNum(aPrinPort) + "</TD><TD ALIGN=RIGHT bgcolor='#CCFFFF'>\$" + formatNum(aIntPort) + "</TD><TD ALIGN=RIGHT bgcolor='#CCFFFF'>\$" + formatNum(aPrin) + "</TD></TR>");
                    }
                    makeTermRow = false;
                }

                if (numDisplay != 0) {
                    numDisplay --;
                }
            }

            var outputStr = '';
            outputStr += '<html><head><title>房屋按揭详细报告 - 房屋买卖 - 51房屋 -加国无忧</title><link href="mortcal.css" rel="stylesheet" type="text/css"></head><body bgcolor="#FFFFFF" text="#000000" leftmargin="20" topmargin="20" marginwidth="20" marginheight="20">';

            outputStr += "<table border=\"0\" width=\"100%\" cellpadding=\"4\" cellspacing=\"0\" align=\"center\" id=\"HeaderPrint\"  style=\"margin-bottom: 15px\"><tr>	<td style=\"padding-top:10px; border-bottom:1px solid #000000\"><img src=\"http://www.51.ca/images/logo_nobg.gif\" border=\"0\" /></td></tr><tr>	<td><a href=\"http://www.51.ca\"><B><FONT COLOR=\"#669900\">http://www.51.ca</FONT></B></a></td>	<td align=\"right\"><FONT COLOR=\"#990000\">当前时间：2016年01月25日 10:11</FONT></td></tr></table>";

            outputStr += '<table border="0" cellspacing="0" cellpadding="0" width="100%" align="center"><tr><td colspan="2"><hr size="3" color="#336600"></td></tr><tr><td><B>分期供款详细报告</B></td><td align="right">' + todayMonth + " " + todayDate + ", " + todayYear + '</td></tr><tr><td colspan="2"><hr size="1" color="#000000"></td></tr></table>';

            var interval = yearTotalPrin.length - 1;
            if (payFreq == 26 || payFreq == 52) {
                interval ++;
            }

            outputStr += '<table width="100%" border="0" cellspacing="0" cellpadding="0" align="center"><tr><td colspan="6" height="25" valign="bottom"><b>摘要信息</b></td></tr><tr><td colspan="6"><img src="http://www.51.ca/images/space.gif" border="0" height="5" width="100%"></td></tr><tr><td colspan="6" bgcolor="#333333"><img src="http://www.51.ca/images/space.gif" border="0" height="1" width="100%"></td></tr><tr><td colspan="6"><img src="http://www.51.ca/images/space.gif" border="0" height="5" width="100%"></td></tr><tr><td height="25"><b>起始日期</b></td><td height="25">' + loanDate + '</td><td height="25"><b>按揭额度</b></td><td height="25">\$' + formatNum(theform.principal.value) + '</td><td height="25"><b>还款次数</b></td><td height="25">' + aNPer + ' 次</td></tr><tr><td height="25"><b>按揭年期</b></td><td height="25">' + noYrs + ' 年</td><td height="25"><b>按揭利率</b></td><td height="25">' + theform.intRate.value + '%</td><td height="25"><B>利率锁定</B></td><td height="25">'+Vterm+' 年</td></tr><tr><td height="25"><b>报告年期</b></td><td>'+ VamortYrs +' 年</td><td height="25"><b>还款周期</b></td><td>'+ freqTxt +'</td><td height="25"><b>每次还款</b></td><td><FONT COLOR="#FF0000"><B>\$' + formatNum(PIP) + '</B></FONT></td></tr><tr><td colspan="6"><hr size="3" color="#336600"></td></tr><tr><td colspan="6"><img src="http://www.51.ca/images/space.gif" border="0" height="3" width="100%"></td></tr></table>';

            outputStr += '<BR><table width="100%" border="0" cellspacing="0" cellpadding="0" align="center"><tr><td bgcolor="#000000" height="25">&nbsp;&nbsp;<FONT COLOR="#FFFFFF"><b>'+ VamortYrs +'</b> 年内的还款进度表';

            if(VamortYrs>Vterm){
                outputStr += ' (蓝底部分为利率锁定年期外的还款计划，按锁定利率估算)';
            }


            outputStr += '</FONT></td></tr><tr><td bgcolor="#000000"><table width="100%" border="0" cellspacing="1" cellpadding="2" align="center"><tr height="22"><td align="center" bgcolor="#F1F1F1"><b>次数</b></td><td align="center" bgcolor="#F1F1F1"><b>日期</b></td><td align="center" bgcolor="#F1F1F1"><b>偿还本金</b></td><td align="center" bgcolor="#F1F1F1"><b>偿还利息</b></td><td align="center" bgcolor="#F1F1F1"><b>所剩余额</b></td></tr>';

            termCount = Vterm - 1;
            makeTermRow = false;

            //if (payFreq != 1) {
            aPmtRow += '<tr><td bgcolor="#000000" height="22" colspan="5">&nbsp;&nbsp;<FONT COLOR="#FFFFFF"><font color="#FFFFFF">供款期内的年度还款汇总表</font></td></tr><tr height="22"><td align="center" bgcolor="#F1F1F1" colspan="2"><b>年度</b></td><td align="center" bgcolor="#F1F1F1"><b>偿还本金</b></td><td align="center" bgcolor="#F1F1F1"><b>偿还利息</b></td><td align="center" bgcolor="#F1F1F1"><b>所剩余额</b></td></tr>';

            for (count = 1; count < interval; count++) {
                if (termCount != 0) {
                    termCount --;
                } else {
                    makeTermRow = true;
                }

                if (makeTermRow == true) {
                    aPmtRow = ("" + aPmtRow + "<TR><TD COLSPAN=2 ALIGN=CENTER BGCOLOR='#F1F1F1'><B>End of Term Total</B></TD><TD ALIGN=RIGHT BGCOLOR='#F1F1F1'><B>\$" + formatNum(yearTotalPrin[count]) + "</B></TD><TD ALIGN=RIGHT BGCOLOR='#F1F1F1'><B>\$" + formatNum(yearTotalInt[count]) + "</B></TD><TD ALIGN=RIGHT BGCOLOR='#F1F1F1'><B>\$" + formatNum(yearTotalBalance[count]) + "</B></TD></TR>");

                    makeTermRow = false;
                    termCount = -1;
                } else {
                    aPmtRow = ("" + aPmtRow + "<TR><TD COLSPAN=2 ALIGN=CENTER BGCOLOR='#FFFFFF'>第 " + count + " 年总计</TD><TD ALIGN=RIGHT BGCOLOR='#FFFFFF'>\$" + formatNum(yearTotalPrin[count]) + "</TD><TD ALIGN=RIGHT BGCOLOR='#FFFFFF'>\$" + formatNum(yearTotalInt[count]) + "</TD><TD ALIGN=RIGHT BGCOLOR='#FFFFFF'>\$" + formatNum(yearTotalBalance[count]) + "</TD></TR>");
                }
            }
            //}

            outputStr += aPmtRow;

            outputStr += '<tr><td colspan="2" align="center" bgcolor="F1F1F1"><b>End of Period Total</b></td><td align=right bgcolor="F1F1F1"><B>\$' + formatNum(aAccumPrin) + '</B></td><td align=right bgcolor="F1F1F1"><B>\$' + formatNum(aAccumInt) + '</B></td><td align="right" bgcolor="F1F1F1"><B>\$0.00</B></td></tr></table></td></tr></table>';

            outputStr += '<table border="0" cellspacing="0" cellpadding="0" width="100%" align="center"><tr><td height="25"><FONT COLOR="#990000">注意：</FONT>此计算结果仅供参考</td><td align="right" height="25"><a href="javascript:window.print();">打印此页</a> | <a href="javascript:self.close()">关闭窗口</a></td></tr></table>';

            outputStr += "<table border=\"0\" width=\"100%\" cellpadding=\"4\" cellspacing=\"0\" align=\"center\" id=\"FooterPrint\" style=\"margin-top: 15px\"><tr>	<td style=\"border-top:1px solid #000000\">&copy; 加国无忧中文网络 51.CA</td></tr></table><br>";

            outputStr += '</body></html>';

            reportWin = window.open("","","toolbar=no,scrollbars=yes, top=10, left=50,resizable=yes,width=550,height=620");

            reportWin.moveTo(20,20);
            reportWin.document.write(outputStr);
            reportWin.document.close();
            //reportWin.opener.close();
            reportWin.focus()
        }


        function clearForm(form) {
            theform.principal.value = "";
            theform.intRate.value = "";
            theform.numYears.value = "";
            theform.moPmt.value = "";
        }
        //-->
    </SCRIPT>

<div class="PopupBody4 PopupTabArea"   leftmargin="0" topmargin="0" marginwidth="0" marginheight="0">

<h2>房屋按揭计算</h2>

<form name="vbform" onSubmit="validate(this)">
    <table class="mort" width="100%" border="0" align="center" cellpadding="0" cellspacing="0">
        <tr>
            <td height="25" nowrap>1. 按揭总额</td>
            <td height="25" align="right">$</td>
            <td height="25"><input type="text" name="principal" size="14"onBlur="if(validNumsDec(this)) { mortCal(document.vbform) }" maxlength="8" value="100000"></td>
            <td height="25">&nbsp;</td>
            <td height="25" bgcolor="#EEEEEE">&nbsp;</td>
            <td height="25" nowrap bgcolor="#EEEEEE">- 请输入您要贷款的金额</td>
            <td height="25" nowrap bgcolor="#EEEEEE">&nbsp;</td>
        </tr>
        <tr>
            <td height="25" nowrap>2. 按揭利率</td>
            <td height="25" align="right">%</td>
            <td height="25"><input type="text" name="intRate" size="14"  onBlur="if(validNumsDec(this)) { mortCal( document.vbform) }" maxlength="6" value="5"></td>
            <td height="25">&nbsp;</td>
            <td height="25" bgcolor="#EEEEEE">&nbsp;</td>
            <td height="25" nowrap bgcolor="#EEEEEE">- 请输入希望贷款的利率</td>
            <td height="25" nowrap bgcolor="#EEEEEE">&nbsp;</td>
        </tr>
        <tr>
            <td height="25" nowrap>3. 利率锁定年期</td>
            <td height="25">&nbsp;</td>
            <td height="25"><input type="text" name="termLength" size="14" onBlur="if(validNums(this)) { mortCal( document.vbform) }" maxlength="2" value="10"></td>
            <td height="25">&nbsp;</td>
            <td height="25" bgcolor="#EEEEEE">&nbsp;</td>
            <td height="25" nowrap bgcolor="#EEEEEE">- 在这个期限内贷款利率维持不变</td>
            <td height="25" nowrap bgcolor="#EEEEEE">&nbsp;</td>
        </tr>
        <tr>
            <td height="25" nowrap>4. 按揭年期</td>
            <td height="25">&nbsp;</td>
            <td height="25"><input type="text" name="numYears" size="14" onBlur="if(validNums(this)){ mortCal( document.vbform)  }" maxlength="2" value="25"></td>
            <td height="25">&nbsp;</td>
            <td height="25" bgcolor="#EEEEEE">&nbsp;</td>
            <td height="25" nowrap bgcolor="#EEEEEE">- 你计划贷款的期限</td>
            <td height="25" nowrap bgcolor="#EEEEEE">&nbsp;</td>
        </tr>
        <tr>
            <td height="25" nowrap>5. 还款周期</td>
            <td height="25">&nbsp;</td>
            <td height="25"><select name="payFreq" onChange="mortCal(document.vbform)">
                <option value="12" selected>Monthly</option>
                <option value="26">Bi-Weekly</option>
                <option value="24">Accelerated Bi-weekly</option>
                <option value="52">Weekly</option>
            </select></td>
            <td height="25">&nbsp;</td>
            <td height="25" bgcolor="#EEEEEE">&nbsp;</td>
            <td height="25" nowrap bgcolor="#EEEEEE">- 您可以选择不同还款周期</td>
            <td height="25" nowrap bgcolor="#EEEEEE">&nbsp;</td>
        </tr>
        <tr>
            <td height="25" nowrap>6. 每次还款额</td>
            <td height="25" align="right"><FONT COLOR="#FF0000"><B>$</B></FONT></td>
            <td height="25" nowrap> <script language="JavaScript1.2">
                if (ie4||DOM2){
                    document.write('<div id="moPmtlayer">'+moPmt+'</div>')
                }else{
                    document.write('<ilayer id=moPmtlayerNS><layer id=moPmtlayerNS_sub></layer></ilayer>')
                }

            </script> </td>
            <td height="25">&nbsp;</td>
            <td height="25" bgcolor="#EEEEEE">&nbsp;</td>
            <td height="25" nowrap bgcolor="#EEEEEE">- <FONT COLOR="#990000">该金额根据以上条件自动计算得出</FONT></td>
            <td height="25" nowrap bgcolor="#EEEEEE">&nbsp;</td>
        </tr>
        <tr>
            <td height="25" colspan="3" nowrap><hr size="1"></td>
            <td height="25">&nbsp;</td>
            <td height="25" colspan="2" bgcolor="#EEEEEE"><hr size="1"></td>
            <td height="25" nowrap bgcolor="#EEEEEE">&nbsp;</td>
        </tr>
        <tr>
            <td height="25" nowrap>7. 报告中包含的年期</td>
            <td height="25">&nbsp;</td>
            <td height="25"> <select name="amortYrs" size="1">
                <option value=00>
                <option value=01>1
                <option value=02>2
                <option value=03>3
                <option value=04>4
                <option value=05>5
                <option value=06>6
                <option value=07>7
                <option value=08>8
                <option value=09>9
                <option value=10 selected>10
                <option value=11>11
                <option value=12>12
                <option value=13>13
                <option value=14>14
                <option value=15>15
                <option value=16>16
                <option value=17>17
                <option value=18>18
                <option value=19>19
                <option value=20>20
                <option value=21>21
                <option value=22>22
                <option value=23>23
                <option value=24>24
                <option value=25>25
                <option value=26>26
                <option value=27>27
                <option value=28>28
                <option value=29>29
                <option value=30>30 </select> </td>
            <td height="25">&nbsp;</td>
            <td height="25" bgcolor="#EEEEEE">&nbsp;</td>
            <td height="25" nowrap bgcolor="#EEEEEE">- 您打算生成报告的时间跨度</td>
            <td height="25" nowrap bgcolor="#EEEEEE">&nbsp;</td>
        </tr>
        <tr>
            <td height="25" nowrap>8. 还款开始时间</td>
            <td height="25">&nbsp;</td>
            <td height="25" nowrap> <select name=month size=1>
                <option value=January selected>一月
                <option value=February>二月
                <option value=March>三月
                <option value=April>四月
                <option value=May>五月
                <option value=June>六月
                <option value=July>七月
                <option value=August>八月
                <option value=September>九月
                <option value=October>十月
                <option value=November>十一月
                <option value=December>十二月</select> <select name=day size=1>
                <option value=1 selected>1
                <option value=2>2
                <option value=3>3
                <option value=4>4
                <option value=5>5
                <option value=6>6
                <option value=7>7
                <option value=8>8
                <option value=9>9
                <option value=10>10
                <option value=11>11
                <option value=12>12
                <option value=13>13
                <option value=14>14
                <option value=15>15
                <option value=16>16
                <option value=17>17
                <option value=18>18
                <option value=19>19
                <option value=20>20
                <option value=21>21
                <option value=22>22
                <option value=23>23
                <option value=24>24
                <option value=25>25
                <option value=26>26
                <option value=27>27
                <option value=28>28
                <option value=29>29
                <option value=30>30
                <option value=31>31 </select> <select name=year size=1>
                <option value=2010>2010
                <option value=2011>2011
                <option value=2012>2012
                <option value=2013>2013
                <option value=2014>2014
                <option value=2015>2015
                <option value=2016 selected>2016
                <option value=2017>2017
                <option value=2018>2018</select>
                <script>
                    <!--
                    var now = new Date();
                    var todayMonth = now.getMonth();
                    if (todayMonth == 0) { todayMonth = "January"; }
                    else if (todayMonth == 1) { todayMonth = "February"; }
                    else if (todayMonth == 2) { todayMonth = "March"; }
                    else if (todayMonth == 3) { todayMonth = "April"; }
                    else if (todayMonth == 4) { todayMonth = "May"; }
                    else if (todayMonth == 5) { todayMonth = "June"; }
                    else if (todayMonth == 6) { todayMonth = "July"; }
                    else if (todayMonth == 7) { todayMonth = "August"; }
                    else if (todayMonth == 8) { todayMonth = "September"; }
                    else if (todayMonth == 9) { todayMonth = "October"; }
                    else if (todayMonth == 10) { todayMonth = "November"; }
                    else if (todayMonth == 11) { todayMonth = "December"; }
                    var todayDate = now.getDate();
                    var todayYear = now.getYear();
                    if (todayYear < 2010) { todayYear = todayYear + 1900; }
                    document.vbform.day.value = todayDate;
                    document.vbform.month.value = todayMonth;
                    document.vbform.year.value = todayYear;
                    //	document.vbform.principal.blur();
                    //-->
                </script>
            <td height="25">&nbsp;</td>
            <td height="25" bgcolor="#EEEEEE">&nbsp;</td>
            <td height="25" nowrap bgcolor="#EEEEEE">- 您计划何时开始还款</td>
            <td height="25" nowrap bgcolor="#EEEEEE">&nbsp;</td>
        </tr>
        <tr>
            <td height="25" colspan="3" nowrap><hr size="1"></td>
            <td height="25">&nbsp;</td>
            <td height="25" colspan="3" bgcolor="#EEEEEE"><hr size="1"></td>
        </tr>
        <tr>
            <td height="25" colspan="3" align="center" nowrap><input class="submit-btn" type="submit" value="生成分期供款详细报告" >
                <script language="JavaScript">
                    <!--
                    mortCal(document.vbform);
                    //-->
                </script> </td>
            <td height="25">&nbsp;</td>
            <td height="25" bgcolor="#EEEEEE">&nbsp;</td>
            <td height="25" nowrap bgcolor="#EEEEEE">- 如有疑问，请联系 <a href="mailto:info@51.ca"><b>info@51.ca</b></a></td>
            <td height="25" nowrap bgcolor="#EEEEEE">&nbsp;</td>
        </tr>

        <!--
        <tr>
          <td colspan="3"><hr size="1"></td>
          <td><img src="http://www.51.ca/images/space.gif" border="0" height="1" width="5"></td>
          <td colspan="3" bgcolor="#EEEEEE"><hr size="1"></td>
        </tr>
        <tr>
          <td colspan="3" height="25" align="center" nowrap><FONT COLOR="#990000">注意：</FONT>此计算结果仅供参考</td>
          <td height="25">&nbsp;</td>
          <td colspan="3" height="25" align="center" bgcolor="#EEEEEE">[<a href="javascript:void(0)" onClick="javascript:self.close()">关闭窗口</a>]</td>
        </tr>
        //-->

    </table>
</form>


</div>
